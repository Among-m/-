# å¡å¯†ç®¡ç†ç³»ç»Ÿ

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„å¡å¯†æˆæƒç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒAPPç”¨æˆ·æ³¨å†Œç™»å½•ã€å¡å¯†ç”Ÿæˆç®¡ç†ã€è®¾å¤‡ç»‘å®šç­‰åŠŸèƒ½ã€‚

## âœ¨ å›¾ç‰‡é¢„è§ˆ
![æ•°æ®æ¦‚è§ˆ](images/æ•°æ®æ¦‚è§ˆ.png)
![é¡¹ç›®ç®¡ç†](images/é¡¹ç›®ç®¡ç†.png)
![å¡å¯†ç®¡ç†](images/å¡å¯†ç®¡ç†.png)
![ç”¨æˆ·ç®¡ç†](images/ç”¨æˆ·ç®¡ç†.png)

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ” ç”¨æˆ·ç³»ç»Ÿ
- **APPç”¨æˆ·æ³¨å†Œ** - æ”¯æŒç”¨æˆ·å/é‚®ç®±/æ‰‹æœºå·æ³¨å†Œ
- **ç”¨æˆ·ç™»å½•** - å¤šæ–¹å¼ç™»å½•ï¼Œè‡ªåŠ¨ç”ŸæˆToken
- **ç”¨æˆ·ç®¡ç†** - å®Œæ•´çš„CRUDæ“ä½œï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰
  - âœ… æŸ¥çœ‹æ‰€æœ‰é€šè¿‡APIæ³¨å†Œçš„ç”¨æˆ·
  - âœ… ç”¨æˆ·è¯¦æƒ…å¼¹çª—ï¼ˆæ˜¾ç¤ºVIPç­‰çº§ã€ç»‘å®šå¡å¯†ã€ç™»å½•ä¿¡æ¯ç­‰ï¼‰
  - âœ… æ·»åŠ æ–°ç”¨æˆ·
  - âœ… ç¼–è¾‘ç”¨æˆ·ä¿¡æ¯ï¼ˆç”¨æˆ·åã€é‚®ç®±ã€æ‰‹æœºå·ã€VIPç­‰çº§ã€ä½™é¢ã€çŠ¶æ€ï¼‰
  - âœ… åˆ é™¤å•ä¸ªç”¨æˆ·
  - âœ… æ‰¹é‡åˆ é™¤ç”¨æˆ·ï¼ˆæ”¯æŒå¤šé€‰ï¼‰
  - âœ… ç¦ç”¨/å¯ç”¨ç”¨æˆ·
  - âœ… æœç´¢åŠŸèƒ½ï¼ˆæŒ‰ç”¨æˆ·å/é‚®ç®±/æ‰‹æœºå·/è®¾å¤‡IDæœç´¢ï¼‰
  - âœ… ç­›é€‰åŠŸèƒ½ï¼ˆæŒ‰çŠ¶æ€ã€VIPç­‰çº§ç­›é€‰ï¼‰

### ğŸ’³ å¡å¯†ç®¡ç†
- **æ‰¹é‡ç”Ÿæˆ** - ä¸€æ¬¡æœ€å¤šç”Ÿæˆ1000ä¸ªå¡å¯†
- **ä¸‰ç§ç±»å‹** - æ—¶é•¿å¡ã€æ°¸ä¹…å¡ã€æ¬¡æ•°å¡
- **è®¾å¤‡ç»‘å®š** - è‡ªåŠ¨ç»‘å®šè®¾å¤‡IDï¼Œæ”¯æŒè§£ç»‘
- **çŠ¶æ€ç®¡ç†** - æœªä½¿ç”¨ã€å·²æ¿€æ´»ã€å·²ç¦ç”¨
- **CSVå¯¼å‡º** - æ‰¹é‡å¯¼å‡ºå¡å¯†æ•°æ®

### ğŸ“± APIæ¥å£
1. **ç”¨æˆ·æ³¨å†Œ** - åˆ›å»ºæ–°ç”¨æˆ·è´¦å·
2. **ç”¨æˆ·ç™»å½•** - Tokenè®¤è¯ç™»å½•
3. **è·å–ç”¨æˆ·ä¿¡æ¯** - æŸ¥è¯¢ç”¨æˆ·è¯¦æƒ…å’Œå¡å¯†åˆ—è¡¨
4. **æ¿€æ´»å¡å¯†** - æ¿€æ´»å¹¶ç»‘å®šè®¾å¤‡
5. **éªŒè¯å¡å¯†** - æ£€æŸ¥å¡å¯†æœ‰æ•ˆæ€§
6. **å¿ƒè·³æ£€æµ‹** - æ›´æ–°ç”¨æˆ·æ´»è·ƒçŠ¶æ€
7. **è·å–å¡å¯†ä¿¡æ¯** - æŸ¥è¯¢å¡å¯†è¯¦æƒ…

### ğŸ“Š ç®¡ç†åŠŸèƒ½
- é¡¹ç›®ç®¡ç† - å¤šé¡¹ç›®ç‹¬ç«‹ç®¡ç†
- ç”¨æˆ·ç®¡ç† - ç»ˆç«¯ç”¨æˆ·åˆ—è¡¨å’ŒçŠ¶æ€
- API Key - ç”Ÿæˆå’Œç®¡ç†APIè®¿é—®ä»¤ç‰Œ
- æ“ä½œæ—¥å¿— - å®Œæ•´çš„æ“ä½œè®°å½•
- æ•°æ®ç»Ÿè®¡ - ç›´è§‚çš„æ•°æ®æ¦‚è§ˆ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç³»ç»Ÿè¦æ±‚
- PHP 7.4+
- PDO SQLiteæ‰©å±•ï¼ˆé»˜è®¤å¯ç”¨ï¼‰
- WebæœåŠ¡å™¨ï¼ˆApache/Nginxï¼‰

### å®‰è£…æ­¥éª¤

1. **ä¸Šä¼ æ–‡ä»¶**
   ```
   å°†æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ åˆ°WebæœåŠ¡å™¨ç›®å½•
   ```

2. **è®¿é—®ç³»ç»Ÿ**
   ```
   æµè§ˆå™¨æ‰“å¼€ï¼šhttp://ä½ çš„åŸŸå/
   ```

3. **é»˜è®¤ç™»å½•**
   ```
   ç”¨æˆ·åï¼šadmin
   å¯†ç ï¼šadmin123456
   ```

4. **ç«‹å³ä¿®æ”¹å¯†ç ** âš ï¸

### ä½¿ç”¨æµç¨‹

```
1. åˆ›å»ºé¡¹ç›®
   â†“
2. ç”Ÿæˆå¡å¯†
   â†“
3. ç”ŸæˆAPI Keyï¼ˆå¯é€‰ï¼‰
   â†“
4. APPè°ƒç”¨æ¥å£
   â†“
5. æŸ¥çœ‹æ•°æ®ç»Ÿè®¡
```

## ğŸ“± APPå¯¹æ¥ç¤ºä¾‹

### Androidç¤ºä¾‹ï¼ˆJavaï¼‰

```java
// 1. ç”¨æˆ·æ³¨å†Œ
JSONObject json = new JSONObject();
json.put("action", "register");
json.put("username", "testuser");
json.put("password", "123456");
json.put("device_id", getDeviceId());

RequestBody body = RequestBody.create(
    MediaType.parse("application/json"), 
    json.toString()
);

Request request = new Request.Builder()
    .url("http://ä½ çš„åŸŸå/api.php")
    .post(body)
    .build();

client.newCall(request).enqueue(new Callback() {
    @Override
    public void onResponse(Call call, Response response) {
        String result = response.body().string();
        JSONObject data = new JSONObject(result);
        if (data.getBoolean("success")) {
            String token = data.getJSONObject("data").getString("token");
            // ä¿å­˜token
            saveToken(token);
        }
    }
});

// 2. æ¿€æ´»å¡å¯†
JSONObject json = new JSONObject();
json.put("action", "activate");
json.put("card_key", "KM-XXXX-XXXX-XXXX-XXXX");
json.put("device_id", getDeviceId());
json.put("device_model", Build.MODEL);
// å‘é€è¯·æ±‚...

// 3. éªŒè¯å¡å¯†ï¼ˆAPPå¯åŠ¨æ—¶ï¼‰
JSONObject json = new JSONObject();
json.put("action", "verify");
json.put("card_key", getCardKey());
json.put("device_id", getDeviceId());
// å‘é€è¯·æ±‚...
```

### è·å–è®¾å¤‡IDï¼ˆAndroidï¼‰
```java
String deviceId = Settings.Secure.getString(
    getContentResolver(), 
    Settings.Secure.ANDROID_ID
);
```

## ğŸ“‹ APIæ¥å£æ–‡æ¡£

### æ¥å£åœ°å€
```
http://ä½ çš„åŸŸå/api.php
```

### è¯·æ±‚æ ¼å¼
```json
{
    "action": "æ¥å£åç§°",
    "å‚æ•°1": "å€¼1",
    "å‚æ•°2": "å€¼2"
}
```

### è¿”å›æ ¼å¼
```json
{
    "success": true,
    "message": "æ“ä½œæˆåŠŸ",
    "timestamp": 1234567890,
    "data": { }
}
```

### æ¥å£åˆ—è¡¨

| æ¥å£ | actionå‚æ•° | å¿…å¡«å‚æ•° | è¯´æ˜ |
|------|-----------|---------|------|
| ç”¨æˆ·æ³¨å†Œ | register | username, password | åˆ›å»ºæ–°ç”¨æˆ· |
| ç”¨æˆ·ç™»å½• | login | username, password | ç™»å½•è·å–token |
| è·å–ç”¨æˆ·ä¿¡æ¯ | get_user_info | token | æŸ¥è¯¢ç”¨æˆ·è¯¦æƒ… |
| æ¿€æ´»å¡å¯† | activate | card_key, device_id | æ¿€æ´»å¹¶ç»‘å®š |
| éªŒè¯å¡å¯† | verify | card_key, device_id | éªŒè¯æœ‰æ•ˆæ€§ |
| å¿ƒè·³æ£€æµ‹ | heartbeat | card_key, device_id | æ›´æ–°æ´»è·ƒ |
| å¡å¯†ä¿¡æ¯ | get_card_info | card_key | æŸ¥è¯¢è¯¦æƒ… |

> è¯¦ç»†æ¥å£æ–‡æ¡£è¯·ç™»å½•åå°æŸ¥çœ‹"ç”¨æˆ·ç®¡ç†"é¡µé¢

## ğŸ”’ å®‰å…¨å»ºè®®

1. **ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç **
2. **ä½¿ç”¨HTTPSåè®®**ï¼ˆæ¨èLet's Encryptï¼‰
3. **å®šæœŸå¤‡ä»½æ•°æ®åº“**ï¼ˆkamika.dbæ–‡ä»¶ï¼‰
4. **ä¿æŠ¤æ•°æ®åº“æ–‡ä»¶**ï¼ˆ.htaccesså·²é…ç½®ï¼‰
5. **å¦¥å–„ä¿ç®¡API Key**

## ğŸ“‚ æ–‡ä»¶ç»“æ„

```
â”œâ”€â”€ config.php          # ç³»ç»Ÿé…ç½®
â”œâ”€â”€ database.php        # æ•°æ®åº“æ“ä½œç±»
â”œâ”€â”€ functions.php       # å…¬å…±å‡½æ•°
â”œâ”€â”€ api.php            # APIæ¥å£
â”œâ”€â”€ index.php          # ç™»å½•é¡µ
â”œâ”€â”€ dashboard.php      # ç®¡ç†åå°
â”œâ”€â”€ logout.php         # é€€å‡º
â”œâ”€â”€ pages/             # åå°é¡µé¢
â”‚   â”œâ”€â”€ overview.php   # æ•°æ®æ¦‚è§ˆ
â”‚   â”œâ”€â”€ projects.php   # é¡¹ç›®ç®¡ç†
â”‚   â”œâ”€â”€ cards.php      # å¡å¯†ç®¡ç†
â”‚   â”œâ”€â”€ users.php      # ç”¨æˆ·ç®¡ç†ï¼ˆå«APIç¤ºä¾‹ï¼‰
â”‚   â”œâ”€â”€ api.php        # API Key
â”‚   â”œâ”€â”€ logs.php       # æ“ä½œæ—¥å¿—
â”‚   â”œâ”€â”€ admins.php     # ç®¡ç†å‘˜
â”‚   â””â”€â”€ settings.php   # ç³»ç»Ÿè®¾ç½®
â”œâ”€â”€ kamika.db          # SQLiteæ•°æ®åº“ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â””â”€â”€ README.md          # æœ¬æ–‡ä»¶
```

## ğŸ’¡ å¼€å‘æç¤º

### æ¨èæŠ€æœ¯æ ˆï¼ˆAndroidï¼‰
- **ç½‘ç»œè¯·æ±‚**: OkHttp + Retrofit
- **JSONè§£æ**: Gson
- **æ•°æ®å­˜å‚¨**: SharedPreferences / Room
- **å¼‚æ­¥å¤„ç†**: RxJava / Coroutines

### å»ºè®®å®ç°
```java
// å°è£…APIç®¡ç†ç±»
public class ApiManager {
    private static final String API_URL = "http://ä½ çš„åŸŸå/api.php";
    
    public void register(String username, String password, Callback callback) {
        // å‘é€æ³¨å†Œè¯·æ±‚
    }
    
    public void login(String username, String password, Callback callback) {
        // å‘é€ç™»å½•è¯·æ±‚
    }
    
    public void verifyCard(String cardKey, Callback callback) {
        // éªŒè¯å¡å¯†
    }
    
    // å®šæ—¶å¿ƒè·³
    private void startHeartbeat() {
        Timer timer = new Timer();
        timer.schedule(new TimerTask() {
            @Override
            public void run() {
                heartbeat();
            }
        }, 0, 5 * 60 * 1000); // æ¯5åˆ†é’Ÿ
    }
}
```

## â“ å¸¸è§é—®é¢˜

**Q: æ•°æ®åº“æ–‡ä»¶åœ¨å“ªé‡Œï¼Ÿ**  
A: ç³»ç»Ÿä¼šè‡ªåŠ¨åœ¨æ ¹ç›®å½•åˆ›å»º `kamika.db` æ–‡ä»¶

**Q: å¦‚ä½•å¤‡ä»½æ•°æ®ï¼Ÿ**  
A: ç›´æ¥ä¸‹è½½ `kamika.db` æ–‡ä»¶å³å¯

**Q: å¿˜è®°ç®¡ç†å‘˜å¯†ç æ€ä¹ˆåŠï¼Ÿ**  
A: åˆ é™¤ `kamika.db` æ–‡ä»¶ï¼Œç³»ç»Ÿä¼šé‡æ–°åˆå§‹åŒ–å¹¶åˆ›å»ºé»˜è®¤è´¦æˆ·

**Q: APIè¿”å›401é”™è¯¯ï¼Ÿ**  
A: Tokenæ— æ•ˆæˆ–å·²è¿‡æœŸï¼Œéœ€è¦é‡æ–°ç™»å½•

**Q: å¡å¯†æ¿€æ´»å¤±è´¥ï¼Ÿ**  
A: æ£€æŸ¥é¡¹ç›®æ˜¯å¦å¯ç”¨ã€å¡å¯†æ˜¯å¦å·²è¢«ä½¿ç”¨ã€è®¾å¤‡æ˜¯å¦å·²ç»‘å®šå…¶ä»–å¡å¯†

**Q: å¦‚ä½•è·å–è®¾å¤‡IDï¼Ÿ**  
A: Androidä½¿ç”¨ `Settings.Secure.ANDROID_ID`ï¼ŒiOSä½¿ç”¨ `IDFV`

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-10-01)
- âœ… é¦–æ¬¡å‘å¸ƒ
- âœ… APPç”¨æˆ·æ³¨å†Œç™»å½•ç³»ç»Ÿ
- âœ… å®Œæ•´çš„å¡å¯†ç®¡ç†åŠŸèƒ½
- âœ… 7ä¸ªAPIæ¥å£
- âœ… å¤šé¡¹ç›®æ”¯æŒ
- âœ… ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ
- âœ… æ—¥å¿—è®°å½•åŠŸèƒ½
- âœ… ç¾è§‚çš„ç®¡ç†åå°

## ğŸ“ æŠ€æœ¯æ”¯æŒ

ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
1. æœ¬READMEæ–‡æ¡£
2. åå°"ç”¨æˆ·ç®¡ç†"é¡µé¢çš„APIç¤ºä¾‹
3. ç³»ç»Ÿerror.logæ—¥å¿—æ–‡ä»¶

## ğŸ“„ å¼€æºåè®®

MIT License

---

**Â© 2025 å¡å¯†ç®¡ç†ç³»ç»Ÿ | å¼€ç®±å³ç”¨ | åŠŸèƒ½å®Œæ•´ | å®‰å…¨å¯é **
