# 用户管理功能测试指南

## 测试前准备

1. 确保你已经登录管理后台
2. 点击左侧菜单的"用户管理"进入用户管理页面

## 测试步骤

### 1️⃣ 查看用户列表

**预期结果：**
- 显示所有通过API注册的用户
- 表格包含以下列：
  - 复选框（用于多选）
  - ID
  - 用户名
  - 邮箱
  - 手机号
  - 等级（普通/VIP/SVIP徽章）
  - 绑定卡密（显示有效/已过期数量）
  - 设备型号
  - 状态
  - 登录次数
  - 最后登录时间
  - 注册时间
  - 操作按钮（查看/编辑/删除）

### 2️⃣ 测试添加用户功能

**步骤：**
1. 点击右上角"添加用户"按钮
2. 填写以下信息：
   - 用户名：`testuser01`（必填）
   - 密码：`123456`（必填）
   - 邮箱：`test@example.com`
   - 手机号：`13800138000`
   - VIP等级：选择"VIP用户"
   - 余额：`100.00`
   - 状态：启用
3. 点击"保存"按钮

**预期结果：**
- 提示"保存成功"
- 页面刷新，新用户出现在列表顶部
- 新用户的VIP徽章为黄色"VIP"

### 3️⃣ 测试查看用户详情

**步骤：**
1. 点击刚添加的用户行中的"眼睛"图标
2. 查看弹窗内容

**预期结果：**
- 弹出用户详情窗口
- 显示：
  - 用户头像图标（蓝色圆形，带用户名首字母）
  - 用户名：testuser01
  - VIP等级徽章
  - 状态徽章（绿色"正常"）
  - 用户ID
  - 邮箱：test@example.com
  - 手机号：13800138000
  - 注册时间
  - 最后登录时间
  - 登录次数：0
  - 设备信息（如果有）
  - 余额：¥100.00
  - 绑定的卡密列表（如果有）

### 4️⃣ 测试编辑用户功能

**步骤：**
1. 关闭详情弹窗
2. 点击用户行中的"铅笔"图标
3. 修改以下信息：
   - 邮箱改为：`newemail@example.com`
   - VIP等级改为：SVIP用户
   - 余额改为：`200.00`
   - 密码留空（不修改密码）
4. 点击"保存"

**预期结果：**
- 提示"保存成功"
- 页面刷新后，用户信息已更新
- VIP徽章变为红色"SVIP"
- 邮箱显示为新邮箱

### 5️⃣ 测试搜索功能

**步骤：**
1. 在搜索框输入：`testuser`
2. 按Enter键或点击"搜索"按钮

**预期结果：**
- 只显示包含"testuser"的用户
- URL变为：`?page=users&search=testuser`

**继续测试：**
3. 点击"重置"按钮

**预期结果：**
- 显示所有用户
- 搜索框清空

### 6️⃣ 测试筛选功能

**步骤：**
1. 在"所有等级"下拉框选择"VIP用户"
2. 页面自动刷新

**预期结果：**
- 只显示VIP等级为1的用户

**继续测试：**
3. 在"所有状态"下拉框选择"禁用"

**预期结果：**
- 只显示被禁用的VIP用户（如果没有，则显示空列表）

### 7️⃣ 测试禁用用户功能

**步骤：**
1. 重置筛选条件
2. 点击testuser01行的"眼睛"图标打开详情
3. 点击底部的"禁用用户"按钮
4. 确认操作

**预期结果：**
- 提示"操作成功"
- 页面刷新
- 该用户的状态变为红色"禁用"徽章

### 8️⃣ 测试多选功能

**步骤：**
1. 勾选表格顶部的全选框

**预期结果：**
- 所有用户都被选中
- 右上角出现红色"批量删除"按钮

**继续测试：**
2. 取消全选框

**预期结果：**
- 所有选中状态取消
- "批量删除"按钮消失

### 9️⃣ 测试批量删除功能

**步骤：**
1. 手动勾选2-3个用户（建议选择测试用户）
2. 点击右上角的"批量删除"按钮
3. 确认删除操作

**预期结果：**
- 弹出确认对话框，显示删除数量
- 确认后提示"批量删除成功"
- 选中的用户从列表中消失

### 🔟 测试单个删除功能

**步骤：**
1. 点击testuser01行的"垃圾桶"图标
2. 确认删除

**预期结果：**
- 弹出确认对话框："确定要删除该用户吗？此操作不可恢复！"
- 确认后提示"删除成功"
- 该用户从列表中消失

## 测试API注册的用户是否显示

### 使用API测试工具测试

**步骤：**
1. 打开Postman或其他API测试工具
2. 发送POST请求到：`https://你的域名/api.php`
3. 请求体（JSON格式）：
```json
{
  "action": "register",
  "username": "apiuser001",
  "password": "123456",
  "email": "apiuser@example.com",
  "phone": "13900139000",
  "device_id": "test_device_123",
  "device_model": "Test Device"
}
```
4. 返回管理后台的用户管理页面
5. 刷新页面

**预期结果：**
- 新注册的用户 `apiuser001` 出现在列表中
- 显示设备型号为"Test Device"
- 状态为"启用"
- VIP等级为"普通"

## 错误处理测试

### 测试重复用户名

**步骤：**
1. 尝试添加用户名已存在的用户

**预期结果：**
- 提示"用户名已存在"
- 不创建新用户

### 测试重复邮箱

**步骤：**
1. 尝试添加邮箱已存在的用户

**预期结果：**
- 提示"邮箱已被使用"

### 测试无效用户名格式

**步骤：**
1. 尝试添加包含特殊字符的用户名（如：`test@user`）

**预期结果：**
- 提示"用户名只能包含字母、数字和下划线"

### 测试密码长度

**步骤：**
1. 添加新用户时输入少于6位的密码

**预期结果：**
- 提示"密码长度不能少于6位"（API层验证）

## 性能测试

### 大量数据测试

如果你有超过100个用户：
1. 检查页面加载速度
2. 检查搜索响应速度
3. 检查多选操作流畅度

**预期结果：**
- 页面加载时间 < 2秒
- 搜索响应时间 < 1秒
- 操作无明显卡顿

## 浏览器兼容性测试

建议在以下浏览器测试：
- ✅ Chrome (推荐)
- ✅ Firefox
- ✅ Edge
- ✅ Safari (Mac)

## 移动端测试

1. 在手机浏览器打开管理后台
2. 测试响应式布局
3. 测试触摸操作

**预期结果：**
- 表格可以横向滚动
- 弹窗适配移动屏幕
- 按钮大小适合触摸

## 常见问题排查

### 问题1：用户列表为空

**原因：**
- 还没有通过API注册的用户

**解决：**
- 使用API测试工具注册几个用户
- 或者使用"添加用户"功能手动添加

### 问题2：点击按钮没有反应

**检查：**
1. 打开浏览器控制台（F12）
2. 查看Console是否有JavaScript错误
3. 查看Network是否有请求失败

### 问题3：弹窗显示不正常

**检查：**
1. 确认Bootstrap 5已正确加载
2. 清除浏览器缓存后重试

## 测试完成检查清单

- [ ] 用户列表正常显示
- [ ] 添加用户功能正常
- [ ] 查看详情弹窗正常
- [ ] 编辑用户功能正常
- [ ] 搜索功能正常
- [ ] 筛选功能正常
- [ ] 多选功能正常
- [ ] 批量删除功能正常
- [ ] 单个删除功能正常
- [ ] 禁用用户功能正常
- [ ] API注册的用户能正常显示
- [ ] 错误提示友好
- [ ] 操作日志正常记录
- [ ] 移动端显示正常

---

如果测试过程中发现任何问题，请记录以下信息：
1. 问题描述
2. 操作步骤
3. 预期结果
4. 实际结果
5. 浏览器版本
6. 错误信息（如果有）


